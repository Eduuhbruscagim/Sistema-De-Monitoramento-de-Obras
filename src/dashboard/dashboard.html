<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Painel - Condomínio App</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <link rel="stylesheet" href="../global.css" />
    <link rel="stylesheet" href="dashboard.css" />
  </head>

  <body>
    <div class="dashboard-container">
      <aside class="sidebar">
        <div class="sidebar-header">
          <img src="../imagens/Logo.webp" alt="Logo" class="sidebar-logo" />
        </div>

        <nav class="sidebar-menu">
          <a
            href="#"
            class="menu-item active"
            data-view="view-dashboard"
            data-title="Visão Geral"
            aria-label="Visão Geral"
            title="Visão Geral"
          >
            <i class="fa-solid fa-house"></i>
            <span>Visão Geral</span>
          </a>

          <a
            href="#"
            class="menu-item"
            data-view="view-relatorios"
            data-title="Relatórios"
            aria-label="Relatórios"
            title="Relatórios"
          >
            <i class="fa-solid fa-file-invoice"></i>
            <span>Relatórios</span>
          </a>

          <a
            href="#"
            class="menu-item"
            data-view="view-moradores"
            data-title="Moradores"
            aria-label="Moradores"
            title="Moradores"
          >
            <i class="fa-solid fa-users"></i>
            <span>Moradores</span>
          </a>

          <a
            href="#"
            class="menu-item"
            data-view="view-reservas"
            data-title="Reservas"
            aria-label="Reservas"
            title="Reservas"
          >
            <i class="fa-solid fa-calendar-check"></i>
            <span>Reservas</span>
          </a>
        </nav>

        <div class="sidebar-footer">
          <a
            href="#"
            class="menu-item logout"
            aria-label="Sair do sistema"
            title="Sair do sistema"
          >
            <i class="fa-solid fa-arrow-right-from-bracket"></i>
            <span>Sair do Sistema</span>
          </a>

          <div class="user-profile-mini">
            <div class="avatar-circle" id="user-avatar">...</div>
            <div class="user-info">
              <strong id="user-name">Carregando...</strong>
              <small id="user-role">...</small>
            </div>
          </div>
        </div>
      </aside>

      <main class="main-content">
        <div class="top-bar">
          <h2 class="page-title">Visão Geral</h2>

          <div class="top-actions">
            <button class="icon-btn" aria-label="Notificações">
              <i class="fa-regular fa-bell"></i>
              <span class="notification-dot"></span>
            </button>
            <button class="btn-settings">
              <i class="fa-solid fa-gear"></i> Configurações
            </button>
          </div>
        </div>

        <!-- VIEW: DASHBOARD -->
        <div id="view-dashboard" class="view-section active">
          <section class="stats-grid">
            <div class="stat-card">
              <div class="icon-box blue">
                <i class="fa-solid fa-wallet"></i>
              </div>
              <div>
                <p class="stat-label">Saldo em Caixa</p>
                <h3 class="stat-value">R$ 42.500</h3>
                <small class="stat-change positive">+12% este mês</small>
              </div>
            </div>

            <div class="stat-card">
              <div class="icon-box purple">
                <i class="fa-solid fa-triangle-exclamation"></i>
              </div>
              <div>
                <p class="stat-label">Ocorrências</p>
                <h3 class="stat-value">3 Abertas</h3>
                <small class="stat-change orange">1 Urgente</small>
              </div>
            </div>

            <div class="stat-card">
              <div class="icon-box green">
                <i class="fa-solid fa-building-user"></i>
              </div>
              <div>
                <p class="stat-label">Unidades</p>
                <h3 class="stat-value">48/50</h3>
                <small class="stat-change text-light">2 Vazias</small>
              </div>
            </div>
          </section>

          <section class="recent-activity">
            <h3 class="section-title">Atividades Recentes</h3>
            <div class="activity-list">
              <div class="activity-item">
                <div class="activity-icon bg-blue">
                  <i class="fa-solid fa-calendar-day"></i>
                </div>
                <div class="activity-info">
                  <h4>Reserva confirmada: Salão de Festas</h4>
                  <p>Apt 402 - Data: 20/01/2026</p>
                </div>
                <span class="activity-time">2h atrás</span>
              </div>
            </div>
          </section>
        </div>

        <!-- VIEW: RELATÓRIOS (NOVO) -->
        <div id="view-relatorios" class="view-section">
          <div style="padding: 10px">
            <h2 class="page-title">Relatórios</h2>
            <p style="color: #64748b; margin-top: 8px">
              Em breve: relatórios financeiros, inadimplência, ocorrências e
              reservas.
            </p>
          </div>

          <div class="activity-list" style="margin-top: 20px">
            <div class="activity-item">
              <div class="activity-icon bg-blue">
                <i class="fa-solid fa-chart-line"></i>
              </div>
              <div class="activity-info">
                <h4>Relatórios ainda não configurados</h4>
                <p>Essa área vai mostrar gráficos e filtros.</p>
              </div>
              <span class="activity-time">Em breve</span>
            </div>
          </div>
        </div>

        <!-- VIEW: MORADORES -->
        <div id="view-moradores" class="view-section">
          <div
            style="
              margin-bottom: 20px;
              display: flex;
              justify-content: flex-end;
            "
          ></div>

          <div class="table-container">
            <table class="glass-table">
              <thead>
                <tr>
                  <th>Morador</th>
                  <th>Unidade</th>
                  <th>Contato</th>
                  <th>Status do Pagamento</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="lista-moradores"></tbody>
            </table>
          </div>
        </div>

        <!-- VIEW: RESERVAS -->
        <div id="view-reservas" class="view-section">
          <div class="reservas-header" style="margin-bottom: 30px">
            <h2 class="page-title">Reservas de Áreas</h2>
            <p style="color: #64748b">Agende seu lazer com antecedência.</p>
          </div>

          <div
            class="areas-grid"
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
              gap: 20px;
              margin-bottom: 40px;
            "
          >
            <div class="stat-card" style="display: block; text-align: center">
              <div class="icon-box purple" style="margin: 0 auto 15px">
                <i class="fa-solid fa-champagne-glasses"></i>
              </div>
              <h3>Salão de Festas</h3>
              <p style="color: #64748b; font-size: 0.9rem; margin-bottom: 20px">
                Capacidade: 40 pessoas<br />
                Ar-condicionado e Freezer
              </p>
              <button
                class="btn btn-primary btn-full"
                onclick="abrirModalReserva('Salão de Festas')"
              >
                Reservar Data
              </button>
            </div>

            <div class="stat-card" style="display: block; text-align: center">
              <div
                class="icon-box orange"
                style="background: #ffedd5; color: #f97316; margin: 0 auto 15px"
              >
                <i class="fa-solid fa-fire-burner"></i>
              </div>
              <h3>Churrasqueira</h3>
              <p style="color: #64748b; font-size: 0.9rem; margin-bottom: 20px">
                Capacidade: 15 pessoas<br />
                Grelha e Área Aberta
              </p>
              <button
                class="btn btn-primary btn-full"
                onclick="abrirModalReserva('Churrasqueira')"
              >
                Reservar Data
              </button>
            </div>
          </div>

          <h3 style="margin-bottom: 15px; color: #0f172a">
            Próximas Ocupações
          </h3>

          <div class="table-container">
            <table class="tabela-reservas-isolada">
              <thead>
                <tr>
                  <th>Data</th>
                  <th>Área</th>
                  <th>Reservado Por</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="lista-reservas"></tbody>
            </table>
          </div>
        </div>
      </main>
    </div>

    <!-- MODAL: NOVO/EDITAR MORADOR -->
    <div id="modal-novo-morador" class="modal-overlay">
      <div class="modal-glass">
        <div class="modal-header">
          <h3>Editar Morador</h3>
          <button class="close-modal" type="button">
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>

        <form id="form-morador">
          <div class="input-group">
            <label>Nome Completo</label>
            <div class="input-wrapper">
              <i class="fa-regular fa-user"></i>
              <input
                type="text"
                id="nome"
                required
                placeholder="Ex: João da Silva"
              />
            </div>
          </div>

          <div class="input-group">
            <label>E-mail (Obrigatório)</label>
            <div class="input-wrapper">
              <i class="fa-regular fa-envelope"></i>
              <input
                type="email"
                id="email-novo"
                required
                placeholder="email@exemplo.com"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="input-group">
              <label>Celular</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-phone"></i>
                <input
                  type="tel"
                  id="celular"
                  required
                  placeholder="(11) 99999-9999"
                />
              </div>
            </div>

            <div class="input-group">
              <label>Tipo</label>
              <select id="tipo" class="glass-select">
                <option value="Proprietário">Proprietário</option>
                <option value="Inquilino">Inquilino</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="input-group">
              <label>Unidade</label>
              <div class="input-wrapper">
                <i class="fa-solid fa-door-closed"></i>
                <input
                  type="text"
                  id="unidade-num"
                  required
                  placeholder="Ex: 402"
                />
              </div>
            </div>

            <div class="input-group">
              <label>Bloco</label>
              <div class="input-wrapper">
                <i class="fa-regular fa-building"></i>
                <input
                  type="text"
                  id="unidade-bloco"
                  required
                  placeholder="Ex: A"
                  style="text-transform: uppercase"
                />
              </div>
            </div>

            <div class="input-group">
              <label>Pagamento</label>
              <select id="status" class="glass-select">
                <option value="ok">Em dia</option>
                <option value="late">Atrasado</option>
              </select>
            </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary"
            style="width: 100%; justify-content: center; margin-top: 10px"
          >
            Salvar Dados
          </button>
        </form>
      </div>
    </div>

    <!-- MODAL: CONFIRMAR EXCLUSÃO -->
    <div id="modal-confirm-delete" class="modal-overlay">
      <div class="modal-glass" style="max-width: 400px; text-align: center">
        <div style="font-size: 3rem; color: #ef4444; margin-bottom: 15px">
          <i class="fa-solid fa-circle-exclamation"></i>
        </div>

        <h3>Tem certeza?</h3>
        <p style="color: #64748b; margin-bottom: 25px">
          Essa ação apagará o morador permanentemente do banco de dados.
        </p>

        <div style="display: flex; gap: 10px; justify-content: center">
          <button
            type="button"
            class="btn btn-outline"
            onclick="fecharModalExclusao()"
            style="border-color: #cbd5e1; color: #64748b"
          >
            Cancelar
          </button>

          <button
            id="btn-confirm-delete"
            class="btn btn-primary"
            style="
              background: #ef4444;
              border: none;
              color: white;
              box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
            "
          >
            Sim, Excluir
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL: CONFIRMAR EXCLUSÃO (RESERVA) -->
    <div id="modal-confirm-delete-reserva" class="modal-overlay">
      <div class="modal-glass" style="max-width: 420px; text-align: center">
        <div style="font-size: 3rem; color: #ef4444; margin-bottom: 15px">
          <i class="fa-solid fa-circle-exclamation"></i>
        </div>

        <h3>Cancelar reserva?</h3>
        <p style="color: #64748b; margin-bottom: 25px">
          Essa ação vai remover a reserva permanentemente.
        </p>

        <div style="display: flex; gap: 10px; justify-content: center">
          <button
            type="button"
            class="btn btn-outline"
            onclick="fecharModalExclusaoReserva()"
            style="border-color: #cbd5e1; color: #64748b"
          >
            Voltar
          </button>

          <button
            id="btn-confirm-delete-reserva"
            type="button"
            class="btn btn-primary"
            style="
              background: #ef4444;
              border: none;
              color: white;
              box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
            "
          >
            Sim, cancelar
          </button>
        </div>
      </div>
    </div>

    <!-- MODAL: NOVA RESERVA -->
    <div id="modal-reserva" class="modal-overlay">
      <div class="modal-glass">
        <div class="modal-header">
          <h3>Nova Reserva</h3>
          <button
            class="close-modal-reserva"
            type="button"
            style="
              background: none;
              border: none;
              font-size: 1.5rem;
              cursor: pointer;
            "
          >
            <i class="fa-solid fa-xmark"></i>
          </button>
        </div>

        <form id="form-reserva">
          <input type="hidden" id="reserva-area" />

          <div
            style="
              background: #f1f5f9;
              padding: 15px;
              border-radius: 12px;
              margin-bottom: 20px;
              text-align: center;
            "
          >
            Você está reservando:
            <strong id="label-area-selecionada" style="color: var(--primary)"
              >...</strong
            >
          </div>

          <div class="input-group">
            <label>Escolha a Data</label>
            <div class="input-wrapper">
              <i class="fa-regular fa-calendar"></i>
              <input type="date" id="reserva-data" required min="2024-01-01" />
            </div>
          </div>

          <button type="submit" class="btn btn-primary btn-full">
            Confirmar Agendamento
          </button>
        </form>
      </div>
    </div>

    <div id="toast-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="dashboard.js"></script>
  </body>
</html>
